devtools::install()                        # install the package so we can try it
# to tez tylko raz przy piewrszym uzyciu, to tworzy strukture folderu
#htmlwidgets::scaffoldWidget("ceterisParibusD3")    # create widget scaffolding
devtools::install()                        # install the package so we can try it
# to tez tylko raz przy piewrszym uzyciu, to tworzy strukture folderu
#htmlwidgets::scaffoldWidget("ceterisParibusD3")    # create widget scaffolding
devtools::install()                        # install the package so we can try it
#przyklad do sprawdzenia dzialania ew. w reszta w pliku initialExample.R do sprawdzenia dzialania
library(ceterisParibusD3)
library("DALEX")
library("randomForest")
library("ceterisParibus")
library("rpart")
library("e1071")
library(ceterisParibusD3)
####################################
# example 1 - ICE lines with points
####################################
apartments_rf_model <- randomForest(m2.price ~ construction.year + surface + floor +
no.rooms + district,
data = apartments)
explainer_rf <- explain(apartments_rf_model,
data = apartmentsTest[,2:6],
y = apartmentsTest$m2.price)
apartments_A <- apartmentsTest[958,]
cp_rf_A <- ceteris_paribus(explainer_rf, apartments_A, y = apartments_A$m2.price)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = TRUE,
color = 'surface', alpha_ices = 1,
selected_variables = c("surface","district"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("district","construction.year"))
unique(cp_rf_A$district)
sort(unique(cp_rf_A$district))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("district","construction.year"),
categorical_order = list('district' = sort(unique(cp_rf_A$district))))
# to tez tylko raz przy piewrszym uzyciu, to tworzy strukture folderu
#htmlwidgets::scaffoldWidget("ceterisParibusD3")    # create widget scaffolding
devtools::install()                        # install the package so we can try it
#przyklad do sprawdzenia dzialania ew. w reszta w pliku initialExample.R do sprawdzenia dzialania
library(ceterisParibusD3)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("district","construction.year"),
categorical_order = list('district' = sort(unique(cp_rf_A$district))))
c(names(categorical_order)[i], categorical_order[[i]], rep(NA,noCol-length(categorical_order[[i]])) )
# to tez tylko raz przy piewrszym uzyciu, to tworzy strukture folderu
#htmlwidgets::scaffoldWidget("ceterisParibusD3")    # create widget scaffolding
devtools::install()                        # install the package so we can try it
#przyklad do sprawdzenia dzialania ew. w reszta w pliku initialExample.R do sprawdzenia dzialania
library(ceterisParibusD3)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("district","construction.year"),
categorical_order = list('district' = sort(unique(cp_rf_A$district))))
# to tez tylko raz przy piewrszym uzyciu, to tworzy strukture folderu
#htmlwidgets::scaffoldWidget("ceterisParibusD3")    # create widget scaffolding
devtools::install()                        # install the package so we can try it
library("DALEX")
library("randomForest")
library("ceterisParibus")
library("rpart")
library("e1071")
library(ceterisParibusD3)
####################################
# example 1 - ICE lines with points
####################################
apartments_rf_model <- randomForest(m2.price ~ construction.year + surface + floor +
no.rooms + district,
data = apartments)
explainer_rf <- explain(apartments_rf_model,
data = apartmentsTest[,2:6],
y = apartmentsTest$m2.price)
apartments_A <- apartmentsTest[958,]
cp_rf_A <- ceteris_paribus(explainer_rf, apartments_A, y = apartments_A$m2.price)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
library("DALEX")
library("randomForest")
library("ceterisParibus")
library("rpart")
library("e1071")
library(ceterisParibusD3)
apartments_rf_model <- randomForest(m2.price ~ construction.year + surface + floor +
no.rooms + district,
data = apartments)
explainer_rf <- explain(apartments_rf_model,
data = apartmentsTest[,2:6],
y = apartmentsTest$m2.price)
apartments_A <- apartmentsTest[958,]
cp_rf_A <- ceteris_paribus(explainer_rf, apartments_A, y = apartments_A$m2.price)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
####################################
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = TRUE)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE)
load_all()
library(devtools)
load_all()
test()
document()
load_all()
test()
document()
load_all()
document()
devtools::load_all()
document()
install.packages('pkgload')
install.packages("pkgload")
library(htmlwidgets)
library(devtools)
document()
build()
install()
library(ceterisParibusD3)
?ceterisParibus::plot_interactive
?ceterisParibusD3::ceterisParibusD3
system("R CMD Rd2pdf .")
# generuje plik pdf z dokuemtnacja
system("R CMD Rd2pdf ceterisParibusD3")
# generuje plik pdf z dokuemtnacja
system("R CMD Rd2pdf .")
# generuje plik pdf z dokuemtnacja
system("R CMD Rd2pdf ceterisParibusD3")
# generuje plik pdf z dokuemtnacja
system("R CMD Rd2pdf .")
# generuje plik pdf z dokuemtnacja
system("R CMD Rd2pdf .")
system("R CMD Rd2pdf . --title=Package ceterisParibusD3 --output=./manual.pdf --force  --internals")
system("R CMD Rd2pdf . --title=Package ceterisParibusD3 --output=./manual.pdf --force")
library("DALEX")
library("randomForest")
library("ceterisParibus")
library("rpart")
library("e1071")
library(ceterisParibusD3)
####################################
# example 1 - ICE lines with points
####################################
apartments_rf_model <- randomForest(m2.price ~ construction.year + surface + floor +
no.rooms + district,
data = apartments)
explainer_rf <- explain(apartments_rf_model,
data = apartmentsTest[,2:6],
y = apartmentsTest$m2.price)
apartments_A <- apartmentsTest[958,]
cp_rf_A <- ceteris_paribus(explainer_rf, apartments_A, y = apartments_A$m2.price)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
####################################
# example 2 ICE lines colored by categorical variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = FALSE,
color = "district", alpha = 1,
selected_variables = c("surface","construction.year", "district", 'no.rooms', 'floor'))
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'))
####################################
# example 3 ICE lines colored by contiuous variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE,
color = "surface", alpha = 1,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = TRUE,
color = 'surface', alpha_ices = 1,
selected_variables = c("surface","construction.year"))
####################################
# example 4 ICE lines, rugs, residuals, points, all with custom colors
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE, show_rugs = TRUE,
show_residuals = TRUE,
color = "blue", color_points = "orange", color_residuals = "red", color_rugs = "green",
alpha = 0.3, alpha_points = 0.3, alpha_residuals = 0.5, alpha_rugs = 1,
size_points = 4, size_rugs = 0.5,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE, show_rugs = TRUE,
show_residuals = TRUE,
color = "blue", color_points = "orange", color_residuals = "red", color_rugs = "green",
alpha_ices = 0.3, alpha_points = 0.3, alpha_residuals = 0.5, alpha_rugs = 1,
size_points = 4,  size_rugs = 0.5,
selected_variables = c("surface","construction.year"))
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year")) +
ceteris_paribus_layer(cp_rf_C,
show_observations = FALSE, show_rugs = FALSE,
aggregate_profiles = mean, size = 2, alpha = 1,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1)
apartments_svm_model <- svm(m2.price ~ construction.year + surface + floor +
no.rooms + district, data = apartments)
apartments_rpart_model <- best.rpart(m2.price ~ construction.year + surface + floor + no.rooms + district, data = apartments)
explainer_svm <- explain(apartments_svm_model,
data = apartmentsTest[,2:6], y = apartmentsTest$m2.price)
explainer_rpart <- explain(apartments_rpart_model,
data = apartmentsTest[,2:6], y = apartmentsTest$m2.price)
apartments_E <- apartmentsTest[958,]
cp_rf_E <- ceteris_paribus(explainer_svm, apartments_E, y = apartments_E$m2.price)
apartments_F <- apartmentsTest[958,]
cp_rpart_F <- ceteris_paribus(explainer_rpart, apartments_F, y = apartments_F$m2.price)
plot(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"))
####################################
# example 5 ICE lines with PDP lines
####################################
apartments_C <- select_sample(apartmentsTest, n = 10)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year")) +
ceteris_paribus_layer(cp_rf_C,
show_observations = FALSE, show_rugs = FALSE,
aggregate_profiles = mean, size = 2, alpha = 1,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1)
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1, width = 800, height = 800)
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1, width = 800, height = 600)
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1, width = 800, height = 600,
size_rugs = 0.5)
####################################
# example 1 - ICE lines with points
####################################
apartments_rf_model <- randomForest(m2.price ~ construction.year + surface + floor +
no.rooms + district,
data = apartments)
explainer_rf <- explain(apartments_rf_model,
data = apartmentsTest[,2:6],
y = apartmentsTest$m2.price)
apartments_A <- apartmentsTest[958,]
cp_rf_A <- ceteris_paribus(explainer_rf, apartments_A, y = apartments_A$m2.price)
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE, height = 400)
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","construction.year"), add_table = FALSE, height = 300)
####################################
# example 2 ICE lines colored by categorical variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = FALSE,
color = "district", alpha = 1,
selected_variables = c("surface","construction.year", "district", 'no.rooms', 'floor'))
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'))
####################################
# example 2 ICE lines colored by categorical variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 5)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = FALSE,
color = "district", alpha = 1,
selected_variables = c("surface","construction.year", "district", 'no.rooms', 'floor'))
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'))
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'), height = 600)
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'), height = 600,
width = 600)
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'), height = 600,
width = 800)
####################################
# example 3 ICE lines colored by contiuous variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE,
color = "surface", alpha = 1,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = TRUE,
color = 'surface', alpha_ices = 1,
selected_variables = c("surface","construction.year"))
####################################
# example 4 ICE lines, rugs, residuals, points, all with custom colors
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE, show_rugs = TRUE,
show_residuals = TRUE,
color = "blue", color_points = "orange", color_residuals = "red", color_rugs = "green",
alpha = 0.3, alpha_points = 0.3, alpha_residuals = 0.5, alpha_rugs = 1,
size_points = 4, size_rugs = 0.5,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C,
show_profiles = TRUE, show_observations = TRUE, show_rugs = TRUE,
show_residuals = TRUE,
color = "blue", color_points = "orange", color_residuals = "red", color_rugs = "green",
alpha_ices = 0.3, alpha_points = 0.3, alpha_residuals = 0.5, alpha_rugs = 1,
size_points = 4,  size_rugs = 0.5,
selected_variables = c("surface","construction.year"))
####################################
# example 5 ICE lines with PDP lines
####################################
apartments_C <- select_sample(apartmentsTest, n = 10)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year")) +
ceteris_paribus_layer(cp_rf_C,
show_observations = FALSE, show_rugs = FALSE,
aggregate_profiles = mean, size = 2, alpha = 1,
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1, width = 800, height = 600,
size_rugs = 0.5)
apartments_svm_model <- svm(m2.price ~ construction.year + surface + floor +
no.rooms + district, data = apartments)
apartments_rpart_model <- best.rpart(m2.price ~ construction.year + surface + floor + no.rooms + district, data = apartments)
explainer_svm <- explain(apartments_svm_model,
data = apartmentsTest[,2:6], y = apartmentsTest$m2.price)
explainer_rpart <- explain(apartments_rpart_model,
data = apartmentsTest[,2:6], y = apartmentsTest$m2.price)
apartments_E <- apartmentsTest[958,]
cp_rf_E <- ceteris_paribus(explainer_svm, apartments_E, y = apartments_E$m2.price)
apartments_F <- apartmentsTest[958,]
cp_rpart_F <- ceteris_paribus(explainer_rpart, apartments_F, y = apartments_F$m2.price)
plot(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"))
plot(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","district"))
ceterisParibusD3(cp_rf_A, show_profiles = TRUE, show_observations = TRUE,
selected_variables = c("surface","district"))
ceterisParibusD3(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"))
ceterisParibusD3(cp_rf_A, cp_rf_E, cp_rpart_F,
color = "_label_",
selected_variables = c("surface","construction.year"), width = 800)
ceterisParibusD3(cp_rf_C,
show_observations = FALSE, show_rugs = TRUE,
show_residuals = TRUE, color_residuals = "red", size_residuals = 2,
selected_variables = c("surface","construction.year"),
aggregate_profiles = 'mean', size_pdps = 5, alpha_pdps = 1, width = 800, height = 600,
size_rugs = 0.5)
knitr::opts_chunk$set(echo = TRUE)
####################################
# example 2 ICE lines colored by categorical variable
####################################
apartments_C <- select_sample(apartmentsTest, n = 15)
cp_rf_C <- ceteris_paribus(explainer_rf, apartments_C, y = apartments_C$m2.price)
plot(cp_rf_C,
show_profiles = TRUE, show_observations = FALSE,
color = "district", alpha = 1,
selected_variables = c("surface","construction.year", "district", 'no.rooms', 'floor'))
# no need to include color variable in selected_variables
ceterisParibusD3(cp_rf_C, show_profiles = TRUE, show_observations = FALSE,
color = 'district', alpha_ices = 1,
selected_variables = c("surface","construction.year", 'no.rooms', 'floor'))
